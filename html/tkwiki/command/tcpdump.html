<!DOCTYPE HTML>
<html>
	<head>
		<link rel="Stylesheet" type="text/css" href="/css/style.css">
		<title>Tcpdump @ TankyWoo's Wiki</title>
		<meta name="keywords" content="TankyWoo, Wiki, vimwiki, linux, python, cpp"/>
		<meta name="description" content="A wiki about Linux, Python, and so on"/>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	</head>
	<body>
		<div id="header">
			<ul>
				<li><a href='/'>Home</a></li>
				<li><a href='http://www.wutianqi.com'>Blog</a></li>
				<li><a href='https://github.com/tankywoo/wiki'>Github</a></li>
			</ul>
		</div>
		<div class="clearfix">
		</div>
		<div id="title">Tcpdump</div>
		<div id="content">
			

<p>
tcpdump is a common packet analyzer that runs under the command line
</p>

<h1 id="toc_1">Syntax</h1>
<p>
Syntax: 
<table>
<tr>
<td>
Protocol
</td>
<td>
Direction
</td>
<td>
Host(s)
</td>
<td>
Value
</td>
<td>
Logical Operations
</td>
<td>
Other expression
</td>
</tr>
</table>
</p>

<p>
Example:
<table>
<tr>
<td>
tcp
</td>
<td>
dst
</td>
<td>
10.1.1.1
</td>
<td>
80
</td>
<td>
and
</td>
<td>
tcp dst 10.2.2.2 3128
</td>
</tr>
</table>
</p>

<h2 id="toc_1.1">Protocol:</h2>
<p>
Values: ether, fddi, ip, arp, rarp, decnet, lat, sca, moprc, mopdl, tcp and udp.
</p>

<p>
If no protocol is specified, all the protocols are used. 
</p>

<h2 id="toc_1.2">Direction:</h2>
<p>
Values: src, dst, src and dst, src or dst
</p>

<p>
If no source or destination is specified, the "src or dst" keywords are applied. 
</p>

<p>
For example, "host 10.2.2.2" is equivalent to "src or dst host 10.2.2.2".
</p>

<h2 id="toc_1.3">Host(s):</h2>
<p>
Values: net, port, host, portrange.
</p>

<p>
If no host(s) is specified, the "host" keyword is used.
</p>

<p>
For example, "src 10.1.1.1" is equivalent to "src host 10.1.1.1". 
</p>

<h2 id="toc_1.4">Logical Operations:</h2>
<p>
Values: not, and, or.
</p>

<p>
Negation ("not") has highest precedence. Alternation ("or") and concatenation ("and") have equal precedence and associate left to right.
</p>

<p>
For example,
</p>

<p>
"not tcp port 3128 and tcp port 23" is equivalent to "(not tcp port 3128) and tcp port 23".
</p>

<p>
"not tcp port 3128 and tcp port 23" is NOT equivalent to "not (tcp port 3128 and tcp port 23)".
</p>

<h1 id="toc_2">Arguments</h1>

<h2 id="toc_2.1">-A</h2>
<p>
print in ASCII
</p>

<h2 id="toc_2.2">-c</h2>
<p>
Specify the receive count 
</p>

<h2 id="toc_2.3">-D</h2>
<p>
Print the list of the network interfaces available on the system and on which tcpdump can capture packets
</p>

<h2 id="toc_2.4">-i</h2>
<p>
Listen on interface
</p>

<h2 id="toc_2.5">-l</h2>
<p>
&gt;&gt; tcpdump -l | tee dat
</p>

<h2 id="toc_2.6">-n</h2>
<p>
Don't convert addresses to names
</p>

<h2 id="toc_2.7">-v/-vv</h2>


<h1 id="toc_3">Read More</h1>

<ul>
<li>
[<a href="http://www.ha97.com/4550.html">http://www.ha97.com/4550.html</a> Linux抓包工具tcpdump详解]

<li>
[<a href="http://www.cnblogs.com/ggjucheng/archive/2012/01/14/2322659.html">http://www.cnblogs.com/ggjucheng/archive/2012/01/14/2322659.html</a> Linux tcpdump命令详解]

<li>
[<a href="http://openmaniak.com/tcpdump.php">http://openmaniak.com/tcpdump.php</a> TCPDUMP - The Easy Tutorial(*)]

<li>
[<a href="http://danielmiessler.com/study/tcpdump/">http://danielmiessler.com/study/tcpdump/</a> A tcpdump Tutorial and Primer]

<li>
[<a href="http://www.tecmint.com/12-tcpdump-commands-a-network-sniffer-tool/">http://www.tecmint.com/12-tcpdump-commands-a-network-sniffer-tool/</a> 12 Tcpdump Commands – A Network Sniffer Tool]

<li>
[<a href="http://en.wikipedia.org/wiki/Tcpdump">http://en.wikipedia.org/wiki/Tcpdump</a> wiki-tcpdump]

</ul>


<h1 id="toc_4">History</h1>
<p>
Create 2013/01/13
</p>

<p>
Last modified 2013/01/13
</p>

		</div>

		<div id="footer">
			<span class="">Copyright © 2012 <a href="http://www.wutianqi.com/" target="_blank">Tanky Woo</a> 
				Powered by <a href="http://www.vim.org/" target="_blank">Vim</a> and <a href="http://code.google.com/p/vimwiki/" target="_blank">Vimwiki</a>
			</span>
		</div>
	</body>
	
	<!-- add _blank to outer links -->
	<script type="text/javascript">
	$("a[href^='http://']").each(function(){
			this.target = "_blank";
	});

	$("a[href^='https://']").each(function(){
			this.target = "_blank";
	});

	$('h2').prepend('>> ')
	$('h3').prepend('>>> ')

	</script>
</html>
